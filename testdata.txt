
lein test versiontracker.db.core-test
2021-10-26 21:06:30,974 [main] INFO  migratus.core - Starting migrations 
2021-10-26 21:06:31,048 [main] INFO  migratus.database - creating migration table 'schema_migrations' 
2021-10-26 21:06:31,139 [main] DEBUG migratus.migrations - Looking for migrations in #object[java.io.File 0x4de5a2ff /run/media/jeroen/MyDocuments/git/github/versiontracker_Main/resources/migrations/mssql] 
2021-10-26 21:06:31,159 [main] INFO  migratus.core - Running up for [202108102130 202110121911] 
2021-10-26 21:06:31,159 [main] INFO  migratus.core - Up 202108102130-add-tables 
2021-10-26 21:06:31,245 [main] DEBUG migratus.migration.sql - found 27 up migrations 
2021-10-26 21:06:31,440 [main] DEBUG migratus.database - marking 202108102130 complete 
2021-10-26 21:06:31,475 [main] INFO  migratus.core - Up 202110121911-add-activetill-column 
2021-10-26 21:06:31,483 [main] DEBUG migratus.migration.sql - found 6 up migrations 
2021-10-26 21:06:31,528 [main] DEBUG migratus.database - marking 202110121911 complete 
2021-10-26 21:06:31,533 [main] INFO  migratus.core - Ending migrations 

lein test versiontracker.handler-test

lein test :only versiontracker.handler-test/test-app

FAIL in (test-app) (handler_test.clj:42)
services success-get-environment
expected: 200
  actual: 500
    diff: - 200
          + 500

lein test :only versiontracker.handler-test/test-app

ERROR in (test-app) (core.clj:158)
services success-get-environment
expected: (s/valid? :versiontracker.validation/environment (m/decode-response-body response))
2021-10-26 21:06:32,676 [main] INFO  versiontracker.db.datacheck - Exist Environment | Checking if the environment: TestEnvironment exists 
  actual: clojure.lang.ExceptionInfo: Unknown response Content-Type: application/octet-stream
{:type :muuntaja/decode, :default-format "application/json", :response {:status 500, :body nil, :headers {"Content-Type" "application/octet-stream", "X-XSS-Protection" "1; mode=block", "X-Frame-Options" "SAMEORIGIN", "X-Content-Type-Options" "nosniff"}}}
 at muuntaja.core$fail_on_response_decode.invokeStatic (core.clj:158)
    muuntaja.core$fail_on_response_decode.invoke (core.clj:155)
    muuntaja.core$create$reify__8376._decode_response_body (core.clj:506)
    muuntaja.core$decode_response_body.invokeStatic (core.clj:544)
    muuntaja.core$decode_response_body.invoke (core.clj:540)
    versiontracker.handler_test$fn__28693$fn__28719.invoke (handler_test.clj:43)
    versiontracker.handler_test$fn__28693.invokeStatic (handler_test.clj:40)
    versiontracker.handler_test/fn (handler_test.clj:22)
    clojure.test$test_var$fn__9761.invoke (test.clj:717)
    clojure.test$test_var.invokeStatic (test.clj:717)
    clojure.test$test_var.invoke (test.clj:708)
    clojure.test$test_vars$fn__9787$fn__9792.invoke (test.clj:735)
    clojure.test$default_fixture.invokeStatic (test.clj:687)
    clojure.test$default_fixture.invoke (test.clj:683)
    clojure.test$test_vars$fn__9787.invoke (test.clj:735)
    versiontracker.handler_test$eval28689$fn__28690.invoke (handler_test.clj:20)
    clojure.test$compose_fixtures$fn__9755$fn__9756.invoke (test.clj:694)
    clojure.test$default_fixture.invokeStatic (test.clj:687)
    clojure.test$default_fixture.invoke (test.clj:683)
    clojure.test$compose_fixtures$fn__9755.invoke (test.clj:694)
    clojure.test$test_vars.invokeStatic (test.clj:731)
    clojure.test$test_all_vars.invokeStatic (test.clj:737)
    clojure.test$test_ns.invokeStatic (test.clj:758)
    clojure.test$test_ns.invoke (test.clj:743)
    user$eval26131$fn__26194.invoke (form-init1255230393410037489.clj:1)
    clojure.lang.AFn.applyToHelper (AFn.java:156)
    clojure.lang.AFn.applyTo (AFn.java:144)
    clojure.core$apply.invokeStatic (core.clj:669)
    clojure.core$apply.invoke (core.clj:662)
    leiningen.core.injected$compose_hooks$fn__25958.doInvoke (form-init1255230393410037489.clj:1)
    clojure.lang.RestFn.applyTo (RestFn.java:137)
    clojure.core$apply.invokeStatic (core.clj:667)
    clojure.core$apply.invoke (core.clj:662)
    leiningen.core.injected$run_hooks.invokeStatic (form-init1255230393410037489.clj:1)
    leiningen.core.injected$run_hooks.invoke (form-init1255230393410037489.clj:1)
    leiningen.core.injected$prepare_for_hooks$fn__25963$fn__25964.doInvoke (form-init1255230393410037489.clj:1)
    clojure.lang.RestFn.applyTo (RestFn.java:137)
    clojure.lang.AFunction$1.doInvoke (AFunction.java:31)
    clojure.lang.RestFn.invoke (RestFn.java:408)
    clojure.core$map$fn__5884.invoke (core.clj:2759)
    clojure.lang.LazySeq.sval (LazySeq.java:42)
    clojure.lang.LazySeq.seq (LazySeq.java:51)
    clojure.lang.Cons.next (Cons.java:39)
    clojure.lang.RT.boundedLength (RT.java:1793)
    clojure.lang.RestFn.applyTo (RestFn.java:130)
    clojure.core$apply.invokeStatic (core.clj:669)
    clojure.test$run_tests.invokeStatic (test.clj:768)
    clojure.test$run_tests.doInvoke (test.clj:768)
    clojure.lang.RestFn.applyTo (RestFn.java:137)
    clojure.core$apply.invokeStatic (core.clj:667)
    clojure.core$apply.invoke (core.clj:662)
    user$eval26131$fn__26204$fn__26237.invoke (form-init1255230393410037489.clj:1)
    user$eval26131$fn__26204$fn__26205.invoke (form-init1255230393410037489.clj:1)
    user$eval26131$fn__26204.invoke (form-init1255230393410037489.clj:1)
    user$eval26131.invokeStatic (form-init1255230393410037489.clj:1)
    user$eval26131.invoke (form-init1255230393410037489.clj:1)
    clojure.lang.Compiler.eval (Compiler.java:7181)
    clojure.lang.Compiler.eval (Compiler.java:7171)
    clojure.lang.Compiler.load (Compiler.java:7640)
    clojure.lang.Compiler.loadFile (Compiler.java:7578)
    clojure.main$load_script.invokeStatic (main.clj:475)
    clojure.main$init_opt.invokeStatic (main.clj:477)
    clojure.main$init_opt.invoke (main.clj:477)
    clojure.main$initialize.invokeStatic (main.clj:508)
    clojure.main$null_opt.invokeStatic (main.clj:542)
    clojure.main$null_opt.invoke (main.clj:539)
    clojure.main$main.invokeStatic (main.clj:664)
    clojure.main$main.doInvoke (main.clj:616)
    clojure.lang.RestFn.applyTo (RestFn.java:137)
    clojure.lang.Var.applyTo (Var.java:705)
    clojure.main.main (main.java:40)
-- Spec failed --------------------

  [:result "Cannot find the environment for requested node"]
  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

should satisfy

  map?

-- Relevant specs -------

:versiontracker.validation/node:
  (clojure.spec.alpha/keys
   :req-un
   [:versiontracker.validation/name :versiontracker.validation/version]
   :opt-un
   [:versiontracker.validation/type
    :versiontracker.validation/deploymentdate
    :versiontracker.validation/comment])
:versiontracker.validation/nodes:
  (clojure.spec.alpha/coll-of :versiontracker.validation/node)

-------------------------
Detected 1 error

lein test :only versiontracker.handler-test/test-app

FAIL in (test-app) (handler_test.clj:47)
services success-get-nodes
expected: 200
  actual: 500
    diff: - 200
          + 500

lein test :only versiontracker.handler-test/test-app

FAIL in (test-app) (handler_test.clj:48)
services success-get-nodes
expected: (s/valid?
           :versiontracker.validation/nodes
           (m/decode-response-body response))
  actual: (not
           (s/valid?
            :versiontracker.validation/nodes
            {:problems
             [{:path [],
               :pred "clojure.core/string?",
               :via [],
               :val nil,
               :in []}],
             :value nil,
             :type "reitit.coercion/response-coercion",
             :spec
             "(spec-tools.core/spec {:spec clojure.core/string?, :type :string, :leaf? true})",
             :coercion "spec",
             :in ["response" "body"]}))
2021-10-26 21:06:32,814 [main] INFO  versiontracker.db.datacheck - Exist Environment | Checking if the environment: TestEnvironment exists 

Ran 5 tests containing 19 assertions.
3 failures, 1 errors.
